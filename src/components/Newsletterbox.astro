<div
  class="wow fadeInUp relative mb-12 overflow-hidden rounded-[5px] bg-primary py-[60px] px-11 text-center lg:px-8"
  data-wow-delay=".1s"
>
  <h3 class="mb-[6px] text-[28px] leading-[40px] font-semibold text-white">
    Join our newsletter!
  </h3>
  <p class="mb-5 text-base text-white">
    Enter your email to receive our latest newsletter.
  </p>
  <form id="newsletter-form">
    <input
      type="email"
      name="email"
      placeholder="Your email address"
      required
      class="mb-4 h-[50px] w-full rounded-md border border-transparent bg-white/10 text-center text-base text-white placeholder:text-white/60 outline-none focus:border-white focus-visible:shadow-none"
    />
    <input
      type="submit"
      value="Subscribe Now"
      class="mb-4 h-[50px] w-full cursor-pointer rounded-md bg-secondary text-center text-sm font-medium text-white transition duration-300 ease-in-out hover:bg-opacity-90 hover:bg-[#0BB489]"
    />
  </form>
  <p class="text-sm font-medium text-white">
    Don't worry, we don't spam
  </p>

  <div>
    <span class="absolute top-0 right-0">
      <svg
        width="46"
        height="46"
        viewBox="0 0 46 46"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle
          cx="1.39737"
          cy="44.6026"
          r="1.39737"
          transform="rotate(-90 1.39737 44.6026)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="1.39737"
          cy="7.9913"
          r="1.39737"
          transform="rotate(-90 1.39737 7.9913)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="13.6943"
          cy="44.6026"
          r="1.39737"
          transform="rotate(-90 13.6943 44.6026)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="13.6943"
          cy="7.9913"
          r="1.39737"
          transform="rotate(-90 13.6943 7.9913)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="25.9911"
          cy="44.6026"
          r="1.39737"
          transform="rotate(-90 25.9911 44.6026)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="25.9911"
          cy="7.9913"
          r="1.39737"
          transform="rotate(-90 25.9911 7.9913)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="38.288"
          cy="44.6026"
          r="1.39737"
          transform="rotate(-90 38.288 44.6026)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="38.288"
          cy="7.9913"
          r="1.39737"
          transform="rotate(-90 38.288 7.9913)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="1.39737"
          cy="32.3058"
          r="1.39737"
          transform="rotate(-90 1.39737 32.3058)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="13.6943"
          cy="32.3058"
          r="1.39737"
          transform="rotate(-90 13.6943 32.3058)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="25.9911"
          cy="32.3058"
          r="1.39737"
          transform="rotate(-90 25.9911 32.3058)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="38.288"
          cy="32.3058"
          r="1.39737"
          transform="rotate(-90 38.288 32.3058)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="1.39737"
          cy="20.0086"
          r="1.39737"
          transform="rotate(-90 1.39737 20.0086)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="13.6943"
          cy="20.0086"
          r="1.39737"
          transform="rotate(-90 13.6943 20.0086)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="25.9911"
          cy="20.0086"
          r="1.39737"
          transform="rotate(-90 25.9911 20.0086)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="38.288"
          cy="20.0086"
          r="1.39737"
          transform="rotate(-90 38.288 20.0086)"
          fill="white"
          fill-opacity="0.44"
        />
      </svg>
    </span>
    <span class="absolute bottom-0 left-0">
      <svg
        width="46"
        height="46"
        viewBox="0 0 46 46"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle
          cx="1.39737"
          cy="44.6026"
          r="1.39737"
          transform="rotate(-90 1.39737 44.6026)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="1.39737"
          cy="7.9913"
          r="1.39737"
          transform="rotate(-90 1.39737 7.9913)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="13.6943"
          cy="44.6026"
          r="1.39737"
          transform="rotate(-90 13.6943 44.6026)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="13.6943"
          cy="7.9913"
          r="1.39737"
          transform="rotate(-90 13.6943 7.9913)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="25.9911"
          cy="44.6026"
          r="1.39737"
          transform="rotate(-90 25.9911 44.6026)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="25.9911"
          cy="7.9913"
          r="1.39737"
          transform="rotate(-90 25.9911 7.9913)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="38.288"
          cy="44.6026"
          r="1.39737"
          transform="rotate(-90 38.288 44.6026)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="38.288"
          cy="7.9913"
          r="1.39737"
          transform="rotate(-90 38.288 7.9913)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="1.39737"
          cy="32.3058"
          r="1.39737"
          transform="rotate(-90 1.39737 32.3058)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="13.6943"
          cy="32.3058"
          r="1.39737"
          transform="rotate(-90 13.6943 32.3058)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="25.9911"
          cy="32.3058"
          r="1.39737"
          transform="rotate(-90 25.9911 32.3058)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="38.288"
          cy="32.3058"
          r="1.39737"
          transform="rotate(-90 38.288 32.3058)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="1.39737"
          cy="20.0086"
          r="1.39737"
          transform="rotate(-90 1.39737 20.0086)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="13.6943"
          cy="20.0086"
          r="1.39737"
          transform="rotate(-90 13.6943 20.0086)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="25.9911"
          cy="20.0086"
          r="1.39737"
          transform="rotate(-90 25.9911 20.0086)"
          fill="white"
          fill-opacity="0.44"
        />
        <circle
          cx="38.288"
          cy="20.0086"
          r="1.39737"
          transform="rotate(-90 38.288 20.0086)"
          fill="white"
          fill-opacity="0.44"
        />
      </svg>
    </span>
  </div>
</div>

<script>
  // Newsletter form with invisible reCAPTCHA
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('newsletter-form');
    
    if (form) {
      form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const emailInput = form.querySelector('input[name="email"]') as HTMLInputElement;
        const email = emailInput?.value;
        
        if (!email) {
          // Show themed notification instead of alert
          const notification = document.createElement('div');
          notification.className = 'fixed top-4 right-4 bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded z-50';
          notification.innerHTML = `
            <div class="flex items-center">
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
              </svg>
              <span>Please enter your email address.</span>
            </div>
          `;
          document.body.appendChild(notification);
          
          // Remove notification after 5 seconds
          setTimeout(() => {
            if (notification.parentNode) {
              notification.parentNode.removeChild(notification);
            }
          }, 5000);
          
          return;
        }
        
        try {
          // Execute invisible reCAPTCHA
          if (window.recaptchaUtils) {
            // Get site key from environment or use test key as fallback
            const siteKey = '6LeIxAcTAAAAAJcZVRqyHh71UMIEGNQ_MXjiZKhI'; // This should be dynamic based on environment
            const recaptchaResponse = await window.recaptchaUtils.execute(siteKey, 'newsletter_signup');
            
            // Submit form data with reCAPTCHA response
            const formData = new FormData();
            formData.append('email', email);
            formData.append('recaptchaResponse', recaptchaResponse);
            
            // Submit to API (you'll need to create this endpoint)
            const response = await fetch('/api/newsletter', {
              method: 'POST',
              body: formData
            });
            
            const result = await response.json();
            
            if (result.success) {
              // Show success notification
              const notification = document.createElement('div');
              notification.className = 'fixed top-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded z-50';
              notification.innerHTML = `
                <div class="flex items-center">
                  <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                  </svg>
                  <span>Thank you for subscribing to our newsletter!</span>
                </div>
              `;
              document.body.appendChild(notification);
              
              // Remove notification after 5 seconds
              setTimeout(() => {
                if (notification.parentNode) {
                  notification.parentNode.removeChild(notification);
                }
              }, 5000);
              
              (form as HTMLFormElement).reset();
            } else {
              // Show error notification
              const notification = document.createElement('div');
              notification.className = 'fixed top-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded z-50';
              notification.innerHTML = `
                <div class="flex items-center">
                  <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                  </svg>
                  <span>Failed to subscribe. Please try again.</span>
                </div>
              `;
              document.body.appendChild(notification);
              
              // Remove notification after 5 seconds
              setTimeout(() => {
                if (notification.parentNode) {
                  notification.parentNode.removeChild(notification);
                }
              }, 5000);
            }
          }
        } catch (error) {
          console.error('Newsletter subscription error:', error);
          // Show error notification
          const notification = document.createElement('div');
          notification.className = 'fixed top-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded z-50';
          notification.innerHTML = `
            <div class="flex items-center">
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
              </svg>
              <span>Failed to subscribe. Please try again.</span>
            </div>
          `;
          document.body.appendChild(notification);
          
          // Remove notification after 5 seconds
          setTimeout(() => {
            if (notification.parentNode) {
              notification.parentNode.removeChild(notification);
            }
          }, 5000);
        }
      });
    }
  });
</script>