---
import Footer from '../components/layout/Footer.astro';
import Header from '../components/layout/Header.astro';
import BackToTop from '../components/layout/BackToTop.astro';
import MadeWithButton from '../components/layout/MadeWithButton.astro';
import CartDrawer from '../components/shared/CartDrawer.astro';



interface Props {
  description: string;
  title: string;
  image?: string;
  theme?: 'light' | 'dark' | 'auto';
}

const { description, title, image, theme = 'auto' } = Astro.props;
---

<!DOCTYPE html>
<html lang="en" data-theme={theme}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <!-- SEO Meta Tags -->
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="generator" content={Astro.generator} />
    
    <!-- Open Graph -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <meta property="og:image" content={image} />
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={image} />
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    
    <!-- Preload Critical Resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" as="style" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" />
    
    <!-- Critical CSS -->
    <style is:global>
      /* Critical CSS for above-the-fold content */
      :root {
        --primary-500: #3b82f6;
        --primary-600: #2563eb;
        --gray-900: #111827;
        --gray-50: #f9fafb;
        --font-family-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      }
      
      * {
        box-sizing: border-box;
      }
      
      html {
        scroll-behavior: smooth;
      }
      
      body {
        font-family: var(--font-family-primary);
        background-color: var(--bg-primary, #ffffff);
        color: var(--text-primary, var(--gray-900));
        line-height: 1.6;
        margin: 0;
        padding: 0;
        overflow-x: hidden;
        overflow-y: auto;
        position: relative;
      }
      
      /* Dark mode support */
      @media (prefers-color-scheme: dark) {
        :root {
          --bg-primary: #111827;
          --text-primary: #f9fafb;
        }
      }
      
      [data-theme="dark"] {
        --bg-primary: #111827;
        --text-primary: #f9fafb;
      }
      
      /* Focus styles for accessibility */
      :focus-visible {
        outline: 2px solid var(--primary-500);
        outline-offset: 2px;
      }
      
      /* Skip to content link */
      .skip-link {
        position: absolute;
        top: -40px;
        left: 6px;
        background: var(--primary-500);
        color: white;
        padding: 8px;
        text-decoration: none;
        border-radius: 4px;
        z-index: 10000;
      }
      
      .skip-link:focus {
        top: 6px;
      }
    </style>
    
    <!-- Non-critical CSS loaded asynchronously -->
    <link rel="stylesheet" href="/src/styles/main.scss" media="print" onload="this.media='all'" />
    <noscript><link rel="stylesheet" href="/src/styles/main.scss" /></noscript>
  </head>
  
  <body>
    <!-- Accessibility: Skip to main content -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Header -->
    <Header />
    
    <!-- Main Content -->
    <main id="main-content">
      <slot />
    </main>
    
    <!-- Footer -->
    <Footer />
    
    <!-- Utility Components -->
    <BackToTop />
    <CartDrawer />
    
    <!-- Theme Script (loads early for better UX) -->
    <script>
      // Theme management
      (function() {
        const theme = document.documentElement.getAttribute('data-theme');
        
        if (theme === 'auto') {
          const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
        }
        
        // Listen for theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
          if (theme === 'auto') {
            document.documentElement.setAttribute('data-theme', e.matches ? 'dark' : 'light');
          }
        });
      })();
    </script>
    
    <!-- Non-critical JavaScript loaded asynchronously -->
    <script type="module" src="/scripts/global-cart-init.js"></script>
    <script type="module" src="/scripts/stickymenu.js"></script>
    <script type="module" src="/scripts/dropdown.js"></script>
    <script type="module" src="/scripts/darkMode.js"></script>
    <script type="module" src="/scripts/scrolltop.js"></script>
    <script type="module" src="/scripts/scrollmenu.js"></script>
    <script type="module" src="/scripts/testimonial.js"></script>
    <script type="module" src="/scripts/scrollAnimations.js"></script>
    <script type="module" src="/scripts/interactiveElements.js"></script>
    <script type="module" src="/scripts/scrollUtils.js"></script>
  </body>
</html>
