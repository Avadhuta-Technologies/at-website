---
// Test page for summary functionality with pre-selected pod
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Summary Test - Pre-selected Pod</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    .test-section {
      background: white;
      padding: 20px;
      margin: 20px 0;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .test-button {
      background: #22c55e;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px;
    }
    .test-button:hover {
      background: #16a34a;
    }
    .result {
      margin-top: 10px;
      padding: 10px;
      background: #f0f0f0;
      border-radius: 4px;
    }
    .error {
      background: #fee;
      color: #c00;
    }
    .success {
      background: #efe;
      color: #0a0;
    }
    .info {
      background: #e3f2fd;
      color: #1976d2;
    }
  </style>
</head>
<body>
  <h1>Summary Test - Pre-selected Pod</h1>
  
  <div class="test-section">
    <h2>Setup Test Pod in Cart</h2>
    <p>First, let's add a test pod to the cart to simulate arriving at the summary page with a pre-selected pod.</p>
    <button 
      data-add-to-cart
      data-item-id="test-pod-summary"
      data-item-type="pod"
      data-item-title="AI Product Studio Pod"
      data-item-description="Complete AI-powered product development team"
      data-item-price="₹29999/month"
      class="test-button">
      Add Test Pod to Cart
    </button>
    <div id="setup-result" class="result info">Click the button above to add a test pod to cart...</div>
  </div>
  
  <div class="test-section">
    <h2>Test Summary Page Navigation</h2>
    <p>After adding the pod to cart, navigate to the summary page to see if it shows the selected pod correctly.</p>
    <button onclick="window.location.href='/summary'" class="test-button">
      Go to Summary Page
    </button>
    <div id="navigation-result" class="result info">Click the button above to test the summary page...</div>
  </div>
  
  <div class="test-section">
    <h2>Expected Behavior</h2>
    <ul>
      <li>✅ Step 1 should show "Your Selected NovaPod" instead of "Choose Your NovaPod"</li>
      <li>✅ The selected pod card should be displayed with pod details</li>
      <li>✅ Reservation period selector should be available (1, 3, 6, 12 months)</li>
      <li>✅ "Continue to Step 2" button should be prominent</li>
      <li>✅ "Change Pod" and "Remove Pod" options should be available</li>
      <li>✅ No list of available pods should be shown</li>
    </ul>
  </div>

  <script>
    function showResult(elementId, message, type = 'info') {
      const element = document.getElementById(elementId);
      element.textContent = message;
      element.className = `result ${type}`;
    }
    
    // Monitor cart service availability
    const checkCartService = () => {
      if (typeof window !== 'undefined') {
        if (window.cartService) {
          showResult('setup-result', '✅ CartService is available and ready for testing', 'success');
          return true;
        } else {
          showResult('setup-result', '⏳ CartService not yet available, waiting...', 'info');
          setTimeout(checkCartService, 100);
          return false;
        }
      }
      return false;
    };

    // Check cart service on load
    checkCartService();

    // Monitor cart events
    if (typeof window !== 'undefined') {
      // Listen for cart service ready event
      window.addEventListener('cart-service-ready', () => {
        showResult('setup-result', '✅ Cart service ready event received', 'success');
      });

      window.addEventListener('cart-updated', (event) => {
        const customEvent = event as CustomEvent;
        showResult('setup-result', `✅ Cart updated event received: ${customEvent.detail?.action || 'unknown'}`, 'success');
        
        // Check if we have a pod in cart
        if (window.cartService) {
          window.cartService.getCart().then(cart => {
            const pod = cart.find(item => item.type === 'pod');
            if (pod) {
              showResult('navigation-result', `✅ Pod found in cart: ${pod.title}. Ready to test summary page!`, 'success');
            }
          });
        }
      });
    }

    // Test button click monitoring
    document.addEventListener('click', (e) => {
      const target = e.target as HTMLElement;
      if (target && target.matches('[data-add-to-cart]')) {
        showResult('setup-result', '🔄 Adding test pod to cart...', 'info');
      }
    });
  </script>
</body>
</html> 