---
import Layout from '../layouts/Layout.astro';
import SummaryHeroSection from '../components/summary/SummaryHeroSection.astro';
import SummaryStepCoordinator from '../components/summary/SummaryStepCoordinator.astro';
---

<Layout title="Summary - NovaPod.ai" description="Complete your NovaPod reservation with our step-by-step process">
  <main class="pt-20">
    <!-- Hero Section with Stepper -->
    <SummaryHeroSection />
    
    <!-- Step Content -->
    <section class="py-16 lg:py-20 bg-white">
      <div class="container mx-auto px-4 max-w-6xl">
        <SummaryStepCoordinator />
      </div>
    </section>
  </main>
</Layout>

<script>
  // Initialize cart service for summary page
  import cartService from '../services/CartService.js';
  
  if (typeof window !== 'undefined') {
    window.cartService = cartService;
  }
  
  // Simple page-level coordination
  document.addEventListener('DOMContentLoaded', async () => {
    console.log('Summary page loaded');
    
    // Clear cart to ensure clean state - no default pods
    try {
      await cartService.clearCart();
      console.log('âœ… Cart cleared on summary page load');
    } catch (error) {
      console.log('Cart clear error (may be normal):', error);
    }
    
    // Initialize with step 1
    window.dispatchEvent(new CustomEvent('step-changed', { 
      detail: { step: 1 } 
    }));
  });
</script>
